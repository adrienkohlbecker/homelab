---


- name: Install base packages
  apt:
    pkg:
      - fail2ban
      - python3 # ansible dep
      - python3-simplejson # ansible dep
      - python3-pip
    state: present
  become: yes
  tags:
    - base

- name: Install pip deps
  pip:
    name: docker # ansible dep for docker module
  become: yes
  tags:
    - base

- name: Setup journald
  template:
    src: journald.conf.j2
    dest: /etc/systemd/journald.conf
    owner: root
    group: root
    mode: 0644
  notify:
    - Restart systemd-journald
  become: yes
  tags:
    - base

- name: Setup rsyslog
  copy:
    src: 00-discard.conf
    dest: /etc/rsyslog.d/00-discard.conf
    owner: root
    group: root
    mode: 0644
  notify:
    - Restart rsyslog
  become: yes
  tags:
    - base
