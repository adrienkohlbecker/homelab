---

- name: Download required seabios from debian
  get_url: url=http://http.us.debian.org/debian/pool/main/s/seabios/seabios_1.7.5-1_all.deb dest=/home/{{ansible_user}}/seabios_1.7.5-1_all.deb
  sudo: true

- name: Install required seabios
  apt: deb=/home/{{ansible_user}}/seabios_1.7.5-1_all.deb
  sudo: true

- name: Add virtualisation ppa
  apt_repository: repo='ppa:jacob/virtualisation' state=present
  sudo: true

- name: Install qemu-kvm
  apt: pkg={{item}} state=installed
  sudo: true
  with_items:
    - qemu-kvm
    - virt-manager

- name: Download virtio drivers for windows
  get_url: url=http://alt.fedoraproject.org/pub/alt/virtio-win/latest/virtio-win-0.1-81.iso dest=/var/lib/libvirt/images/virtio-win-0.1-81.iso owner=libvirt-qemu group=kvm
  sudo: true

- name: Configure directory permissions
  file: dest=/var/lib/libvirt/images owner=libvirt-qemu group=kvm mode=0770
  sudo: true

- name: Add ansibleremote to libvirtd group
  user: name=ansibleremote groups=libvirtd append=yes
  sudo: true
