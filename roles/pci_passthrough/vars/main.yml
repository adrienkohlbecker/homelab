---

# Used to grep ids from lspci
vfio_device_names:
  - Radeon HD
  - Pitcairn HDMI Audio
  - 'USB EHCI #1'

pci_stub_device_names:
  - Radeon HD
  - Pitcairn HDMI Audio
  - 'USB EHCI #1'
  # - Renesas

driver_modules_blacklist:
  - radeon
  - snd_usb_audio # C-Media soundcard
  - uvcvideo # Logitech webcam

# In normal & recovery mode
grub_cmdline: boot=zfs rpool=rpool bootfs=rpool/ROOT/ubuntu-1 nomodeset

# Only in normal mode (non-recovery)
grub_cmdline_default: iommu=1 intel_iommu=on pci_stub.ids={{pci_stub_device_ids}} cgroup_enable=memory swapaccount=1

grub_config:
- { regexp: '^(#?)GRUB_CMDLINE_LINUX=', line: 'GRUB_CMDLINE_LINUX="{{grub_cmdline}}"'}
- { regexp: '^(#?)GRUB_CMDLINE_LINUX_DEFAULT=', line: 'GRUB_CMDLINE_LINUX_DEFAULT="{{grub_cmdline_default}}"'}
- { regexp: '^(#?)GRUB_GFXMODE', line: 'GRUB_GFXMODE=640x480'}
- { regexp: '^(#?)GRUB_TERMINAL', line: 'GRUB_TERMINAL=console'}
