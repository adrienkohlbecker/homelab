- name: path | Install sort_ini@.path {{ sort_ini_escaped_path }}
  import_role:
    name: systemd_unit
    tasks_from: template
  vars:
    systemd_unit_src: sort_ini@.path
    systemd_unit_dest: sort_ini@{{ sort_ini_escaped_path }}.path
  tags:
    - _check_stage1

- name: path | Enable the service
  when: not (ansible_check_mode and systemd_unit.changed)
  systemd:
    name: sort_ini@{{ sort_ini_escaped_path }}.path
    enabled: true
  become: true

- name: path | Start the service
  when: not (ansible_check_mode and systemd_unit.changed) and not docker_test
  systemd:
    name: sort_ini@{{ sort_ini_escaped_path }}.path
    state: started
  register: systemd_started
  become: true

- name: path | Restart the service
  when: not (ansible_check_mode and systemd_unit.changed) and not docker_test and (systemd_unit.changed and not systemd_started.changed)
  systemd:
    name: sort_ini@{{ sort_ini_escaped_path }}.path
    state: restarted
  become: true
