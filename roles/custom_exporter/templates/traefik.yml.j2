http:
  routers:
    custom_exporter:
      entryPoints:
        - websecure
      service: custom_exporter
      rule: Host(`custom-exporter.{{ domain }}`) || Host(`custom-exporter.{{ inventory_hostname }}.{{ domain }}`)
      tls: {}
      middlewares:
        - custom_redirect_to_metrics
  services:
    custom_exporter:
      loadBalancer:
        servers:
          - url: 'http://localhost:19392/'
  middlewares:
    custom_redirect_to_metrics:
      redirectRegex:
        regex: ^https://([^/]+)/?$
        replacement: "https://${1}/metrics"
