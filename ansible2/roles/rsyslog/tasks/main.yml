- name: Uninstall rsyslog
  apt:
    pkg:
      - rsyslog
    state: absent
  become: yes
  tags:
    - rsyslog

- name: Find legacy rsyslog log files
  find:
    paths: /var/log
    patterns: "^{{item}}(\\.[0-9]+)?(\\.gz)?"
    use_regex: yes
  loop:
    - auth.log
    - syslog
    - cron.log
    - daemon.log
    - kern.log
    - lpr.log
    - mail.log
    - user.log
    - mail.info
    - mail.warn
    - mail.err
    - debug
    - messages
    - dmesg
  register: legacy_logs
  become: yes
  tags:
    - rsyslog

- name: Delete legacy rsyslog log files
  file:
    path: "{{ item }}"
    state: absent
  loop: "{{ legacy_logs.results | map(attribute='files') | flatten | map(attribute='path') }}"
  become: yes
  tags:
    - rsyslog
